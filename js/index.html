<!DOCTYPE html>
<html>
<head>
<title>JInfinote tests</title>
<meta  charset="utf-8">
<meta http-equiv="content-script-type" content="text/javascript">
<script type='text/javascript' src='diff_match_patch.js'></script>
<script type='text/javascript' src='jinfinote-r2.1.js'></script>
<script type='text/javascript'>
    var initial_segment = new Segment(0, "abcdefghi");
    var initial_buffer = new Buffer([initial_segment]);
    var state = new State(initial_buffer);
    var r1_segment = new Segment(2, "ac");
    var r1_buffer = new Buffer([r1_segment]);
    var r1_operation = new Operations.Insert(2, r1_buffer); 
    var r1_vector = new Vector();
    var r1 = new DoRequest(2, r1_vector, r1_operation);
    var executed_r1 = state.execute(r1);
    document.write('Request 1:' + executed_r1.toString() + "<br/>");
    document.write('&nbsp;&nbsp;Vector 1:' + state.vector.toString() + "<br/>");
    document.write('&nbsp;&nbsp;&nbsp;Result 1:' + state.buffer + "<br/><br/>"); //outputs abaccdefghi
    //so far so good
    var r2_segment = new Segment(3, "bc");
    var r2_buffer = new Buffer([r2_segment]);
    var r2_operation = new Operations.Insert(3, r2_buffer);
    var r2_vector = new Vector();
    var r2 = new DoRequest(3, r2_vector, r2_operation);
    var executed_r2 = state.execute(r2);
    document.write('Request 2:&nbsp;' + executed_r2.toString() + "<br/>");
    document.write('&nbsp;&nbsp;Vector 2:&nbsp;' + state.vector.toString() + "<br/>");
    document.write('&nbsp;&nbsp;Result 2:&nbsp;' + state.buffer + "<br/><br/>"); // outputs "abaccbcdefghi"
    var r3_operation = new Operations.Delete(0, 5);
    var r3_vector = new Vector(); 
    var r3 = new DoRequest(4, r3_vector, r3_operation);
    var executed_r3 = state.execute(r3);
    document.write('Request 3:&nbsp;' + executed_r3.toString() + "<br/>");
    document.write('&nbsp;&nbsp;Vector 3:&nbsp;' + state.vector.toString() + "<br/>");
    document.write('&nbsp;&nbsp;Result 3:&nbsp;' + state.buffer + "<br/><br/>"); // outputs "acbcfghi"
    //var r4_vector = new Vector() 
    //var r4 = new UndoRequest(4, r4_vector);
    //var executed_r4 = state.execute(r4);
    //document.write('<br/>Request 4:&nbsp;' + executed_r4.toString() + "<br/>");
    //document.write('&nbsp;&nbsp;Vector 4:&nbsp;' + state.vector.toString() + "<br/>");
    //document.write('&nbsp;&nbsp;Result 4:&nbsp;' + state.buffer + "<br/>"); // outputs "acbcfghi"
    var r5_segment = new Segment(5, "BLABLA");
    var r5_buffer = new Buffer([r5_segment]);
    var r5_operation = new Operations.Insert(4, r5_buffer);
    var r5_vector = new Vector();
    var r5 = new DoRequest(5, r5_vector, r5_operation);
    var executed_r5 = state.execute(r5);
    document.write('Request 2:&nbsp;' + executed_r5.toString() + "<br/>");
    document.write('&nbsp;&nbsp;Vector 2:&nbsp;' + state.vector.toString() + "<br/>");
    document.write('&nbsp;&nbsp;Result 2:&nbsp;' + state.buffer + "<br/><br/>"); // outputs "abaccbcdefghi"
</script>
</head>
</html>
